<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Slimtable test 1</title>

  <!-- Load jquery 2.2.1 -->
  <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
  <script src="../js/slimtable.js"></script>

  <!-- Load local QUnit. -->
  <link rel="stylesheet" href="../node_modules/qunitjs/qunit/qunit.css" media="screen">
  <script src="../node_modules/qunitjs/qunit/qunit.js"></script>

</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture">

	<table id='testTable'>
	<thead>
	<tr>
		<th>ID</th>
		<th>First name</th>
		<th>Last name</th>
		<th>Age</th>
		<th>Company</th>
	</tr>
	</thead>

	<tbody>
		<tr data-id="1"><td>1</td><td>Alisa</td><td>Smith</td><td>34</td><td>Unemployed</td></tr>
		<tr data-id="1"><td>2</td><td>Eamon</td><td>Jones</td><td>26</td><td>Example corp</td></tr>
		<tr data-id="1"><td>3</td><td>David</td><td>Brown</td><td>22</td><td>Example corp</td></tr>
		<tr data-id="1"><td>4</td><td>Joseph</td><td>Taylor</td><td>43</td><td>Example corp</td></tr>
		<tr data-id="1"><td>5</td><td>Thomas</td><td>Moore</td><td>67</td><td>Nextgen corp</td></tr>
		<tr data-id="1"><td>6</td><td>Daniel</td><td>White</td><td>19</td><td>Unemployed</td></tr>
		<tr data-id="1"><td>7</td><td>Steven</td><td>Harris</td><td>38</td><td>Nextgen corp</td></tr>
		<tr data-id="1"><td>8</td><td>Brian</td><td>Clark</td><td>82</td><td>Metalking</td></tr>
		<tr data-id="1"><td>9</td><td>Kevin</td><td>Lewis</td><td>71</td><td>Metalking</td></tr>
		<tr data-id="1"><td>10</td><td>Jason</td><td>Allen</td><td>58</td><td>Example corp</td></tr>
		<tr data-id="1"><td>11</td><td>Mary</td><td>Walker</td><td>32</td><td>Prevgen</td></tr>
		<tr data-id="1"><td>12</td><td>Lisa</td><td>Young</td><td>33</td><td>Example corp</td></tr>
		<tr data-id="1"><td>13</td><td>Nancy</td><td>King</td><td>64</td><td>Fakecorp</td></tr>
		<tr data-id="1"><td>14</td><td>Brian</td><td>White</td><td>38</td><td>Prevgen</td></tr>
		<tr data-id="1"><td>15</td><td>Stewen</td><td>Lewis</td><td>22</td><td>Fakecorp</td></tr>
	</tbody>

	</table>

  </div>


<script type='text/javascript'>
$(function() {
	$("#testTable").slimtable({
		keepAttrs: [ "data-id" ]
	});

	test('basic test', function() {
		var thfound=0,
		    trfound=0;

		expect(4);

		// Table should have 5 TH elements with attributes 'unselectable'='on'
		$("#testTable").find("thead").each(function(){
			$(this).find("th").each(function(){
				if( $(this).attr("unselectable") === "on" )
					thfound++;
			});
		});
		equal(thfound, 5, "Proper number of th's found");

		// Table should have 10 Tr elements
		$("#testTable").find("tbody").each(function(){
			$(this).find("tr").each(function(){
				if($(this).attr("data-id") == "1")
					trfound++;
			});
		});
		equal(trfound, 10, "Proper number of tr's found, round 1");

		// Table should be inside div with class 'slimtable-container-div'
		ok( $("#testTable").parent().hasClass("slimtable-container-div"),
			"Table is properly enclosed inside div" );

		// Try to change number of items
		var obj = $("#testTable").parent().find("select").first();
		obj.find("option:nth-child(1)").attr("selected","selected");
		obj.find("option:nth-child(2)").removeAttr("selected");
		obj.trigger("change");

		// Table should now have 5 Tr elements
		trfound = 0;
		$("#testTable").find("tbody").each(function(){
			$(this).find("tr").each(function(){
				if($(this).attr("data-id") == "1")
					trfound++;
			});
		});
		equal(trfound, 5, "Proper number of tr's found, round2");
	});
});
</script>

</body>

</html>
